<div align="center">

# TripleS: ç¼“è§£é«˜åˆ†è¾¨ç‡é¥æ„Ÿå½±åƒè¯­ä¹‰å˜åŒ–æ£€æµ‹ä¸­çš„å¤šä»»åŠ¡å­¦ä¹ å†²çª

[![è®ºæ–‡](https://img.shields.io/badge/Paper-ISPRS%20J%20Photogramm%20Remote%20Sens-blue)](https://www.sciencedirect.com/science/article/pii/S0924271625003776)
[![é¡¹ç›®](https://img.shields.io/badge/Project-GitHub-green)](https://github.com/StephenApX/MTL-TripleS)
[![æ•°æ®é›†](https://img.shields.io/badge/Dataset-Zenodo-orange)](https://zenodo.org/records/17218853)
[![è®¸å¯è¯](https://img.shields.io/badge/License-Research%20Only-red)](#license)

</div>

## ğŸ“– æ¦‚è¿°

æœ¬ä»“åº“åŒ…å«äº† **TripleS** çš„å®˜æ–¹å®ç°ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºé«˜åˆ†è¾¨ç‡é¥æ„Ÿå½±åƒè¯­ä¹‰å˜åŒ–æ£€æµ‹çš„æ–°å‹å¤šä»»åŠ¡å­¦ä¹ æ¡†æ¶ï¼Œå·²å‘è¡¨åœ¨ [ISPRS Journal of Photogrammetry and Remote Sensing](https://www.sciencedirect.com/science/article/pii/S0924271625003776)ã€‚

### ä¸»è¦è´¡çŒ®

- **MOSCDæ¨¡å‹**ï¼šé¢å‘å¤šä»»åŠ¡å­¦ä¹ çš„è¯­ä¹‰å˜åŒ–æ£€æµ‹æ¨¡å‹ï¼Œèƒ½å¤Ÿç›¸äº’å¢å¼ºåŒæ—¶ç›¸ç‰¹å¾ï¼ŒåŒæ—¶ç¡®ä¿å­ä»»åŠ¡åˆ†æ”¯é—´è¡¨ç¤ºçš„ä¸€è‡´æ€§å…³è”ã€‚
- **TripleSæ¡†æ¶**ï¼šåŒ…å«ä¸‰ä¸ªæ–°é¢–æ–¹æ¡ˆçš„ç»¼åˆä¼˜åŒ–æ¡†æ¶ï¼š
  - **é€æ­¥å¤šä»»åŠ¡ä¼˜åŒ–**ï¼šMTLä»»åŠ¡çš„æ¸è¿›å¼è®­ç»ƒç­–ç•¥
  - **é€‰æ‹©æ€§å‚æ•°ç»‘å®š**ï¼šè·¨ä»»åŠ¡çš„ç­–ç•¥æ€§å‚æ•°å…±äº«
  - **åŠ¨æ€è°ƒåº¦**ï¼šMTLç»‘å®šçš„è‡ªé€‚åº”è®­ç»ƒè°ƒåº¦
- **å¤§è§„æ¨¡åŸºå‡†æ•°æ®é›†**ï¼šè¦†ç›–ä¸­å›½ä¸åŒåœºæ™¯çš„ä¸¤ä¸ªæ–°æ•°æ®é›†ï¼š
  - **SC-SCD7**ï¼šåå—åœ°åŒºæ•°æ®é›†ï¼ŒåŒ…å«7ä¸ªè¯­ä¹‰ç±»åˆ«
  - **CC-SCD5**ï¼šåä¸­åœ°åŒºæ•°æ®é›†ï¼ŒåŒ…å«5ä¸ªè¯­ä¹‰ç±»åˆ«

### ç ”ç©¶å½±å“

æˆ‘ä»¬çš„å·¥ä½œè§£å†³äº†è¯­ä¹‰å˜åŒ–æ£€æµ‹å¤šä»»åŠ¡å­¦ä¹ ä¸­ç›®æ ‡å†²çªçš„æ ¹æœ¬æŒ‘æˆ˜ï¼Œä¸ºé«˜åˆ†è¾¨ç‡é¥æ„Ÿåº”ç”¨æä¾›äº†ç¨³å¥çš„è§£å†³æ–¹æ¡ˆã€‚

## ğŸ—ï¸ æ¶æ„

### MOSCDæ¨¡å‹
ä½¿ç”¨TripleSæ¡†æ¶ä¼˜åŒ–çš„é¢å‘å¤šä»»åŠ¡å­¦ä¹ çš„è¯­ä¹‰å˜åŒ–æ£€æµ‹æ¨¡å‹ï¼š

<div align="center">
<img src="./docs/MOSCD.png" alt="MOSCDæ¶æ„" width="800"/>
</div>

### TripleSæ¡†æ¶ç»„ä»¶

#### é€æ­¥ä¼˜åŒ–ä¸é€‰æ‹©æ€§å‚æ•°ç»‘å®š
<div align="center">
<img src="./docs/triS-SS.png" alt="é€æ­¥ä¼˜åŒ–" width="600"/>
</div>

#### åŠ¨æ€è°ƒåº¦ç­–ç•¥
<div align="center">
<img src="./docs/scheduling.png" alt="è°ƒåº¦ç­–ç•¥" width="600"/>
</div>

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Python 3.9+
- CUDA 11.6+
- PyTorch 1.12.0+

### å®‰è£…

1. **åˆ›å»ºå¹¶æ¿€æ´»condaç¯å¢ƒï¼š**
```bash
conda create -n triples python=3.9
conda activate triples
```

2. **å®‰è£…ä¾èµ–ï¼š**
```bash
conda install pytorch==1.12.0 torchvision==0.13.0 cudatoolkit=11.6 pillow numpy tqdm matplotlib segmentation-models-pytorch opencv -c pytorch -c conda-forge
pip install segmentation-models-pytorch==0.3.4
```

### æ•°æ®é›†å‡†å¤‡

#### æ”¯æŒçš„æ•°æ®é›†

1. **[HRSCD](https://ieee-dataport.org/open-access/hrscd-high-resolution-semantic-change-detection-dataset)** - é«˜åˆ†è¾¨ç‡è¯­ä¹‰å˜åŒ–æ£€æµ‹æ•°æ®é›†
2. **[SC-SCD7 & CC-SCD5](https://zenodo.org/records/17218853)** - æˆ‘ä»¬æå‡ºçš„å¤§è§„æ¨¡åŸºå‡†æ•°æ®é›†

#### æ•°æ®ç»„ç»‡

æ ¹æ® `/txt` ç›®å½•ä¸­ `.txt` æ–‡ä»¶æŒ‡å®šçš„ç»“æ„ç»„ç»‡æ•°æ®é›†ï¼š

```
MTL-TripleS/
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ HRSCD/
â”‚   â”‚   â”œâ”€â”€ train/
â”‚   â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ SCSCD7/
â”‚   â””â”€â”€ CCSCD5/
â””â”€â”€ txt/
    â”œâ”€â”€ HRSCD/
    â”‚   â”œâ”€â”€ train_HRSCD_512.txt
    â”‚   â””â”€â”€ test_HRSCD_512.txt
    â””â”€â”€ ...
```

## ğŸ”§ è®­ç»ƒä¸è¯„ä¼°

### è®­ç»ƒé€‰é¡¹

#### 1. è”åˆè®­ç»ƒ
åŒæ—¶è®­ç»ƒæ‰€æœ‰ä»»åŠ¡ï¼š
```bash
python train_jointly.py --config_file ./configs/HRSCD/MOSCD_triS.json
```

#### 2. TripleS-Aè®­ç»ƒ
ä½¿ç”¨TripleSäº¤æ›¿ç­–ç•¥è®­ç»ƒï¼š
```bash
python train_tripleS_A.py --config_file ./configs/SCSCD7/MOSCD_triS.json
```

#### 3. TripleS-Cè®­ç»ƒ
ä½¿ç”¨TripleSçº§è”ç­–ç•¥è®­ç»ƒï¼š
```bash
python train_tripleS_C.py --config_file ./configs/HRSCD/MOSCD_triS.json
```

### æ¨¡å‹æƒé‡
è®­ç»ƒå¥½çš„æ¨¡å‹æƒé‡å°†ä¿å­˜åœ¨ `trained_models/` ç›®å½•ä¸­ï¼Œç»“æ„å¦‚ä¸‹ï¼š
```
trained_models/
â”œâ”€â”€ hrscd_512/MOSCD_triS/
â”œâ”€â”€ scscd7_512/MOSCD_triS/
â””â”€â”€ ccscd5_512/MOSCD_triS/
```

### æ¨ç†ä¸è¯„ä¼°

åœ¨æµ‹è¯•æ•°æ®é›†ä¸Šè¿è¡Œæ¨ç†å’Œè¯„ä¼°ï¼š
```bash
python infereval.py --config_file ./configs/CCSCD5/MOSCD_triS.json \
                   --ckpt_path ./trained_models/ccscd5_512/MOSCD_triS/MOSCD_triS_1/state/checkpoint.pth.tar
```

**è¾“å‡º**ï¼šé¢„æµ‹ç»“æœå°†ä¿å­˜åœ¨ `infer/` ç›®å½•ä¸­ã€‚

### é…ç½®æ–‡ä»¶

æ¯ä¸ªæ•°æ®é›†åœ¨ `configs/` ç›®å½•ä¸­éƒ½æœ‰å¯¹åº”çš„é…ç½®æ–‡ä»¶ï¼š
- `configs/HRSCD/MOSCD_triS.json` - HRSCDæ•°æ®é›†é…ç½®
- `configs/SCSCD7/MOSCD_triS.json` - SC-SCD7æ•°æ®é›†é…ç½®  
- `configs/CCSCD5/MOSCD_triS.json` - CC-SCD5æ•°æ®é›†é…ç½®

å…³é”®é…ç½®å‚æ•°ï¼š
- `model`ï¼šæ¨¡å‹æ¶æ„ï¼ˆMOSCDï¼‰
- `backbone`ï¼šç‰¹å¾æå–å™¨ï¼ˆefficientnet-b0ã€resnet50ç­‰ï¼‰
- `batch_size`ï¼šè®­ç»ƒæ‰¹æ¬¡å¤§å°
- `learning_rate`ï¼šä¼˜åŒ–å­¦ä¹ ç‡
- `epochs`ï¼šè®­ç»ƒè½®æ•°

## ğŸ“Š å®éªŒç»“æœ

### SC-SCD7æ•°æ®é›†æ€§èƒ½
<div align="center">
<img src="./docs/exp-scscd7.png" alt="SC-SCD7ç»“æœ" width="730"/>
</div>

### HRSCDæ•°æ®é›†æ€§èƒ½
<div align="center">
<img src="./docs/exp-hrscd.png" alt="HRSCDç»“æœ" width="500"/>
</div>

### å…³é”®æ€§èƒ½æŒ‡æ ‡

æˆ‘ä»¬çš„TripleSæ¡†æ¶åœ¨å¤šä¸ªè¯„ä¼°æŒ‡æ ‡ä¸Šéƒ½å±•ç°å‡ºæ˜¾è‘—æ”¹è¿›ï¼š

- **å˜åŒ–æ£€æµ‹**ï¼šå¢å¼ºçš„äºŒå€¼å˜åŒ–æ£€æµ‹ç²¾åº¦
- **è¯­ä¹‰åˆ†å‰²**ï¼šæ”¹è¿›çš„åŒæ—¶ç›¸å›¾åƒè¯­ä¹‰ç±»åˆ«é¢„æµ‹
- **å¤šä»»åŠ¡æ•ˆç‡**ï¼šåœ¨ä¿æŒæ€§èƒ½çš„åŒæ—¶å‡å°‘è®­ç»ƒæ—¶é—´
- **æ³›åŒ–èƒ½åŠ›**ï¼šåœ¨ä¸åŒåœ°ç†åŒºåŸŸå’ŒåœŸåœ°è¦†ç›–ç±»å‹ä¸Šçš„ç¨³å¥æ€§èƒ½

## ğŸ“š å¼•ç”¨

å¦‚æœæ‚¨å‘ç°è¿™é¡¹å·¥ä½œå¯¹æ‚¨çš„ç ”ç©¶æœ‰ç”¨ï¼Œè¯·è€ƒè™‘å¼•ç”¨æˆ‘ä»¬çš„è®ºæ–‡ï¼š

```bibtex
@article{tan2025triples,
  title={TripleS: Mitigating multi-task learning conflicts for semantic change detection in high-resolution remote sensing imagery},
  author={Tan, Xiaoliang and Chen, Guanzhou and Zhang, Xiaodong and Wang, Tong and Wang, Jiaqi and Wang, Kui and Miao, Tingxuan},
  journal={ISPRS Journal of Photogrammetry and Remote Sensing},
  volume={230},
  pages={374--401},
  year={2025},
  publisher={Elsevier},
  issn = {0924-2716},
  doi = {https://doi.org/10.1016/j.isprsjprs.2025.09.019},
}
```


## ğŸ“„ è®¸å¯è¯

æ­¤ä»£ç ä»…ç”¨äº**éå•†ä¸šå’Œç ”ç©¶ç›®çš„**ã€‚å¦‚éœ€å•†ä¸šåº”ç”¨ï¼Œè¯·è”ç³»ä½œè€…è·å–è®¸å¯å®‰æ’ã€‚

## ğŸ™ è‡´è°¢

æˆ‘ä»¬è¡·å¿ƒæ„Ÿè°¢ä¸ºè¿™é¡¹å·¥ä½œåšå‡ºè´¡çŒ®çš„ä»¥ä¸‹é¡¹ç›®ï¼š

- **ä»£ç å‚è€ƒ**ï¼š
  - [ClearSCD](https://github.com/tangkai-RS/ClearSCD) - æ¸…æ™°è¯­ä¹‰å˜åŒ–æ£€æµ‹æ¡†æ¶
  - [torchange](https://github.com/Z-Zheng/pytorch-change-models/tree/main) - PyTorchå˜åŒ–æ£€æµ‹æ¨¡å‹

--

<div align="center">

**â­ å¦‚æœæ‚¨è§‰å¾—è¿™ä¸ªé¡¹ç›®æœ‰å¸®åŠ©ï¼Œè¯·è€ƒè™‘ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼â­**

</div>